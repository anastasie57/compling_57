## Задание

### **Тема: Языковое моделирование**

#### **Дедлайн**: 26.01.25 23:59

### Задание
#### Пункт 1: Ngrammer
В семинаре для генерации мы использовали предположение Маркова и считали, что слово зависит только от 1 предыдущего слова. Но ничто нам не мешает попробовать увеличить размер окна и учитывать два или даже три прошлых слова. Для них мы еще сможем собрать достаточно статистик и, логично предположить, что качество сгенерированного текста должно вырасти.

Попробуйте сделать языковую модель, которая будет учитывать два предыдущих слова при генерации текста.
Сгенерируйте несколько текстов (3-5) и расчитайте перплексию получившейся модели. 
Можно использовать текст Булгакова, корпус Ленты или любые другие тексты (можно брать только часть текста, если считается слишком долго). Перплексию рассчитывайте на 10-50 отложенных предложениях (они не должны использоваться при сборе статистик).

Подсказки:  
    - нужно будет добавить еще один тэг \<start>  
    - можете использовать тот же подход с матрицей вероятностей, но по строкам хронить биграмы, а по колонкам униграммы 
    - тексты должны быть очень похожи на нормальные (если у вас получается рандомная каша, вы что-то делаете не так)
    - у вас будут словари с индексами биграммов и униграммов, не перепутайте их при переводе индекса в слово - словарь биграммов будет больше словаря униграммов и все индексы из униграммного словаря будут формально подходить для словаря биграммов (не будет ошибки при id2bigram[unigram_id]), но маппинг при этом будет совершенно неправильным 

#### Пункт 2: Beam Search
Измените функцию **generate_with_beam_search** так, чтобы она работала с моделью, которая учитывает два предыдущих слова. 
Как отличаются результаты до и после изменения функции? 
Также попробуйте начинать генерацию не с нуля (подавая \<start> \<start>), а с какого-то промпта. Но помните, что учитываться будут только два последних слова, так что не делайте длинные промпты.

**Что сдать**
1. Тетрадка с кодом в формате IPYNB

#### Критерии оценки
Является обязательным оформление домашней работы в Jupyter Notebook с ответами на вопросы, комментариями и по PEP-8.
<table>
    <tr><th>Макс. балл</th><th>Критерий</th></tr>
    <tr><td>8</td><td>пункт 1</td></tr>    
    <tr><td>2</td><td>пункт 1</td></tr>    
</table>
